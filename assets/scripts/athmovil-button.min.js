window.athmWindow=null,function($){"use strict";athMovilInit();var athMovilBtn=null,athReferenceNum=null;function athMovilInit(){$("#place_order").after('<div id="ATHMovil_Checkout_Button" style="display:none;"></div><input id="athm_referenceNumber" name="athm_referenceNumber" type="hidden" value="" />'),"athmovil"!=$('form.checkout input[name^="payment_method"]:checked').val()?($("#place_order").show(),$("#ATHMovil_Checkout_Button").hide(),$(".athm_disclaimer").hide()):($("#place_order").hide(),$("#ATHMovil_Checkout_Button").show(),$(".athm_disclaimer").show()),$("#ATHMreopen-modal, .ATHMmodal-content").remove(),$("#ATHMovil_Checkout_Button").off("click"),$("form.checkout").off("click",'input[name="payment_method"]',onPaymentMethodChange),$("form.checkout").on("click",'input[name="payment_method"]',onPaymentMethodChange),$("form.checkout").off("change","#shipping_method",onShippingMethodChange),$("form.checkout").on("change","#shipping_method",onShippingMethodChange),$.getScript(ATHM_Checkout.scriptUrl)}function onPaymentMethodChange(e){var isATHMovil=$(this).is("#payment_method_athmovil"),toggleATHMovil=isATHMovil?"show":"hide",toggleSubmit=isATHMovil?"hide":"show";$("#woo_pp_ec_button_checkout").length>0&&"block"==$("#woo_pp_ec_button_checkout").css("display")?$("#woo_pp_ec_button_checkout, .payment_box").animate({opacity:toggleSubmit,height:toggleSubmit,padding:toggleSubmit},230):$("#place_order, .payment_box").animate({opacity:toggleSubmit,height:toggleSubmit,padding:toggleSubmit},230),$("#ATHMovil_Checkout_Button, .payment_box.payment_method_athmovil").animate({opacity:toggleATHMovil,height:toggleATHMovil,padding:toggleATHMovil},230),isATHMovil?($(".athm_disclaimer").show(),$("#place_order").addClass("pbHide"),e.stopImmediatePropagation()):($(".athm_disclaimer").hide(),$("#place_order").removeClass("pbHide"))}function onShippingMethodChange(e){setTimeout(()=>{$.ajax({url:ATHM_Checkout.ajaxUrl+"?action=athmovil_update_totals",dataType:"json"}).done((function(data){ATHM_Checkout.total=data.total,ATHM_Checkout.tax=data.tax,ATHM_Checkout.subtotal=data.subtotal,ATHM_Checkout.metadata1="Shipping total: "+data.shipping}))},500)}function onCheckoutButtonClick(e){e.preventDefault();let isAwesome=null;isAwesome="object"==typeof awsm&&null!=awsm.checkout&&null!=awsm.checkout;var formData=$("form.checkout").serializeArray(),data={};data.isAwesome=isAwesome,isAwesome&&(data.userEmail=document.getElementById("email").value),formData.forEach(d=>{data[d.name]=d.value}),$.ajax({method:"POST",url:ATHM_Checkout.ajaxUrl+"?action=athmovil_validate_checkout",data:data,dataType:"json"}).done((function(data){"success"==data.result?(ATHM_Checkout.ready=!0,window.athMovilSubmitPayment(e)):$("form.checkout").submit()}))}ATHM_Checkout.onCompletedPayment=function(response){$("#athm_referenceNumber").val(response.referenceNumber),$("form.checkout").submit()},ATHM_Checkout.onCancelledPayment=function(response){},ATHM_Checkout.onExpiredPayment=function(response){},$("body").on("update_checkout",(function(){athMovilBtn=$("#ATHMovil_Checkout_Button"),athReferenceNum=$("#athm_referenceNumber")})),$("body").on("updated_checkout",(function(){$("#place_order").after(athMovilBtn),$("#place_order").after(athReferenceNum),$("form.checkout").off("click","#ATHMovil_Checkout_Button",onCheckoutButtonClick),$("form.checkout").on("click","#ATHMovil_Checkout_Button",onCheckoutButtonClick),"athmovil"!=$('form.checkout input[name^="payment_method"]:checked').val()?($("#place_order").show(),$("#ATHMovil_Checkout_Button").hide(),$(".athm_disclaimer").hide()):($("#place_order").hide(),$("#ATHMovil_Checkout_Button").show(),$(".athm_disclaimer").show())})),$("body").on("checkout_error",(function(e){$('form.checkout input[name="payment_method"]:checked').val()}))}(jQuery);